{"version":3,"sources":["views/selected-view.js"],"names":["SelectedView","Backbone","View","extend","tagName","this","selectedFood","$","initialize","listenTo","selectedFoods","render","models","forEach","model","totalCalorise","get","calCalories","text","toFixed","alert","foodTemplate","_","template","html"],"mappings":"YAAA,IAAIA,cAAeC,SAASC,KAAKC,QAAjCC,QAAIJ,gBAEFI,WAAS,WAGPC,KAAKC,aAAeC,EAAE,iBADxBC,KAAAA,YAAYD,EAAA,gBAKVF,KAAKI,SAASC,cAAe,QAASL,KAAKM,QAD3CN,KAAAI,SAAAC,cAAA,MAAAL,KAAAM,QACAD,cAAcA,OAAAA,OAAd,KAGDC,OAZqC,WActCA,GAAAA,GAAQ,CACND,eAAAE,OAAAC,QAAA,SAAAC,GAE6B,GAA7BJ,EAAAA,IAAcE,cACZG,GAAAD,EAAAE,IAAA,eADF,gBAAAD,GAOEV,KAAKY,YAAYC,KAAK,mBAAqBH,EAAcI,QAAQ,IAAjEC,MAAKH,6BAMP,IAAII,GAAeC,EAAEC,SAAUhB,EAAE,oBAAoBiB,QAASlB,aAAcI,cAAcE,QAC1F,OAFAP,MAAAC,aAAAkB,KAAAH,GAEKf","file":"selected-view.js","sourcesContent":["var SelectedView = Backbone.View.extend({\r\n\r\n  tagName: '#selectedFood',\r\n\r\n  initialize: function() {\r\n    this.selectedFood = $('#selectedFood');\r\n    this.calCalories = $('#calCalories');\r\n\r\n    // 获取localStorage的内容，并render\r\n    this.listenTo(selectedFoods, 'reset', this.render);\r\n    this.listenTo(selectedFoods, 'all', this.render);\r\n    selectedFoods.fetch({reset: true});\r\n  },\r\n\r\n  render: function() {\r\n    // 计算卡路里总数\r\n    var totalCalorise = 0;\r\n    selectedFoods.models.forEach(function(model) {\r\n      // 卡路里为0不计算\r\n      if (model.get('calories') == 0) return;\r\n      totalCalorise += model.get('calories');\r\n    });\r\n\r\n    if (typeof(totalCalorise) === 'number') {\r\n      this.calCalories.text('total calories: ' + totalCalorise.toFixed(2));\r\n    } else {\r\n      alert('model的calories参数不是number类型');\r\n    }\r\n\r\n    // render the selected food\r\n    var foodTemplate = _.template( $('#select-template').html(), {selectedFood: selectedFoods.models});\r\n    this.selectedFood.html(foodTemplate);\r\n\r\n    return this;\r\n  }\r\n});\r\n"]}