{"version":3,"sources":["views/calories-view.js"],"names":["CalCaloriesView","Backbone","View","extend","tagName","this","selectedFood","$","initialize","calCalories","addOne","listenTo","selectedFoods","render","fetch","reset","models","forEach","model","totalCalorise","get","text","toFixed","alert","food","view","SeletedFoodView","append","el","addAll","html","each","destroy"],"mappings":"YAAA,IAAIA,iBAAkBC,SAASC,KAAKC,QAApCC,QAAIJ,aAEFI,WAAS,WAGPC,KAAKC,aAAeC,EAAE,iBADxBC,KAAAA,YAAYD,EAAA,gBAEVF,KAAKI,SAAAA,cAAgB,MAArBJ,KAAAK,QAEAL,KAAKM,SAASC,cAAe,QAAOP,KAAKK,QAEzCL,KAAKM,SAASC,cAAe,MAA7BP,KAAsCQ,QAGtCD,cAAcE,OAAQC,OAAO,KAC9BF,OAdwC,WAgBzCA,GAAAA,GAAQ,CAaL,OAZDD,eAAAI,OAAAC,QAAA,SAAAC,GAE6B,GAA7BN,EAAAA,IAAcI,cACZG,GAAAD,EAAAE,IAAA,eADF,gBAAAD,GAOEd,KAAKI,YAAYY,KAAK,mBAAqBF,EAAcG,QAAQ,IAAjEC,MAAKd,8BAGNJ,MAGFK,OAhCwC,SAAAc,GAiCzC,GAAAC,GAAA,GAAAC,kBAAAR,MAAAM,GACAd,MAAAA,aAAQiB,OAAUH,EAAMX,SAAAe,KAGvBC,OArCwC,WAsCzCxB,KAAAC,aAAAwB,KAAA,IACAD,cAAQE,KAAA1B,KAAYK,OAAAL,OAElBO,MAAAA,WAzCuCP,KAAAa,MAAAc","file":"calories-view.js","sourcesContent":["var CalCaloriesView = Backbone.View.extend({\r\n\r\n  tagName: '#calculate',\r\n\r\n  initialize: function() {\r\n    this.selectedFood = $('#selectedFood');\r\n    this.calCalories = $('#calCalories');\r\n\r\n    this.listenTo(selectedFoods, 'add', this.addOne);\r\n    // 初始化获取localStorage的内容，并render\r\n    this.listenTo(selectedFoods, 'reset', this.addAll);\r\n\r\n    this.listenTo(selectedFoods, 'all', this.render);\r\n    selectedFoods.fetch({ reset: true });\r\n  },\r\n\r\n  render: function() {\r\n    // 计算卡路里总数\r\n    var totalCalorise = 0;\r\n    selectedFoods.models.forEach(function(model) {\r\n      // 卡路里为0不计算\r\n      if (model.get('calories') == 0) return;\r\n      totalCalorise += model.get('calories');\r\n    });\r\n\r\n    if (typeof totalCalorise === 'number') {\r\n      this.calCalories.text('Total Calories: ' + totalCalorise.toFixed(2));\r\n    } else {\r\n      alert('model的calories参数不是number类型');\r\n    }\r\n\r\n    return this;\r\n  },\r\n  // 增加一个food到卡路里计算列表中\r\n  addOne: function (food) {\r\n    var view = new SeletedFoodView({ model: food });\r\n    this.selectedFood.append(view.render().el);\r\n  },\r\n  // Add all items in the **Todos** collection at once.\r\n  addAll: function () {\r\n    this.selectedFood.html('');\r\n    selectedFoods.each(this.addOne, this);\r\n  },\r\n  clear: function () {\r\n    this.model.destroy();\r\n  }\r\n});\r\n"]}